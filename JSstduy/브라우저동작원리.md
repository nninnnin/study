브라우저의 핵심 기능은 사용자가 참조하고자 하는 웹페이지를 서버에 요청하고 서버의 응답을 받아 (Request, Response) 브라우저에 표시하는 것이다. 브라우저는 서버로부터 HTML, CSS, Javascript, 이미지파일 등을 응답받는다. HTML, CSS 파일은 렌더링 엔진의 HTML parser와 CSS parser에 의해 Parsing되어 DOM, CSSOM트리로 변환되고 렌더 트리로 결합된다. 이렇게 생성된 렌더 트리를 기반으로 브라우저는 웹페이지를 표시한다.
!['browser'](./웹브라우저.jpg
)

자바스크립트는 렌더링엔진이 아닌 자바스크립트 엔진이 처리한다.

HTML parser는 script태그를 만나면 자바스크립트 코드를 실행하기 위해 DOM 생성 프로세스를 중지하고 자바스크립트 엔진으로 제어 권한을 넘긴다. 제어 권한을 넘겨 받은 자바스크립트 엔진은 script태그 내의 자바스크립트 코드 또는 script태그의 src attribute에 정의된 자바스크립트 파일을 로드하고 파싱하여 실행한다. 자바스크립틔 실행이 완료되면, 다시 HTML parser로 제어 권한을 넘겨서 브라우저가 중지했던 시점부터 DOM생성을 재개한다.

이처럼 브라우저는 동기적으로 HTML,CSS,Javascript를 처리한다. 이것은 script태그의 위치에 따라 블로킹이 발생하여 DOM 생성이 지연될 수 있다는 것을 의미한다. **따라서 script 태그의 위치는 중요한 의미를 갖는다.**

body요소의 가장 아래에 자바스크립트를 위치시키는 것은 좋은 생각이다. 그 이유는,

- HTML요소들이 스크립트 로딩 지연으로 렌더링에 지장받는 일이 발생하지 않아 페이지 로딩 시간이 단축된다.
- DOM이 완성되지 않은 상태에서 자바스크립트가 DOM을 조작한다면 에러가 발생한다.

관련 reference
- https://d2.naver.com/helloworld/59361


파싱과 DOM트리 구축

파싱은 렌더링 엔진에서 매우 중요한 과정이다.

***문서 파싱은 브라우저가 코드를 이해하고 사용할 수 있는 구조로 변환하는 것을 의미한다***

문서 파싱은 브라우저가 코드를 이해하고 사용할 수 있는 구조로 변환하는 것을 의미한다. 파싱 결과는 보통 문서 구조를 나타내는 노드 트리인데 파싱트리 (parse tree) 또는 문법트리 (syntax tree)라고 부른다.

파싱은 문서에 작성된 언어 또는 형식의 규칙을 따르는데 파싱할 수 있는 모든 형식은 정해진 용어와 구문 규칙에 따라야한다. 이것을 **문맥자유문법**이라고 한다. 인간의 언어는 이런 모습과는 다르기 때문에 기계적으로 파싱이 불가능하다.

